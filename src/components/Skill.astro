---
interface Props {
  title: string;
  description: string;
  img?: string;
  svg?: string;
}

const { description, title, img, svg } = Astro.props;
---

<div class="skill">
  {svg ? (
    <div class="icon icon-svg" set:html={svg} />
  ) : img ? (
    <img src={img} alt={`${title} icon`} class="icon" />
  ) : null}
  <h4>{title}</h4>
  <p>{description}</p>
</div>

<style>
  .icon-svg {
    width: 80px;
    height: 80px;
    color: var(--color-accent);
    animation: iconFadeIn 0.6s ease-out forwards;
    opacity: 0;
  }

  .skill:nth-child(1) .icon-svg {
    animation-delay: 0.1s;
  }

  .skill:nth-child(2) .icon-svg {
    animation-delay: 0.25s;
  }

  .skill:nth-child(3) .icon-svg {
    animation-delay: 0.4s;
  }

  @keyframes iconFadeIn {
    0% {
      opacity: 0;
      transform: scale(0.8) translateY(8px);
    }
    60% {
      transform: scale(1.03) translateY(0);
    }
    100% {
      opacity: 1;
      transform: scale(1) translateY(0);
    }
  }

  .icon-svg :global(svg) {
    width: 100%;
    height: 100%;
  }

  /* Evidence led - Gear rotation (first two paths are the gear, third is the brain) */
  .skill:nth-child(1) .icon-svg :global(svg g path:nth-child(1)),
  .skill:nth-child(1) .icon-svg :global(svg g path:nth-child(2)) {
    transform-box: fill-box;
    transform-origin: center center;
    animation: gearRotate 1s ease-out 0.3s forwards;
  }

  @keyframes gearRotate {
    0% {
      transform: rotate(-45deg);
    }
    70% {
      transform: rotate(10deg);
    }
    100% {
      transform: rotate(0deg);
    }
  }

  /* Systems fluent - Content appears sequentially like being written */
  .skill:nth-child(2) .icon-svg :global(.content-box) {
    opacity: 0;
    animation: contentPopIn 0.4s ease-out 0.3s forwards;
  }

  .skill:nth-child(2) .icon-svg :global(.content-line1) {
    opacity: 0;
    animation: contentPopIn 0.4s ease-out 0.55s forwards;
  }

  .skill:nth-child(2) .icon-svg :global(.content-line2) {
    opacity: 0;
    animation: contentPopIn 0.4s ease-out 0.8s forwards;
  }

  @keyframes contentPopIn {
    0% {
      opacity: 0;
      transform: scaleX(0.3);
      transform-origin: left center;
    }
    100% {
      opacity: 1;
      transform: scaleX(1);
      transform-origin: left center;
    }
  }

  /* Outcome focused - Dot and X pop in, arrow is static */
  .skill:nth-child(3) .icon-svg :global(.dot) {
    opacity: 0;
    transform-box: fill-box;
    transform-origin: center center;
    animation: dotPopIn 0.5s ease-out 0.4s forwards;
  }

  .skill:nth-child(3) .icon-svg :global(.x-mark) {
    opacity: 0;
    transform-box: fill-box;
    transform-origin: center center;
    animation: xPopIn 0.4s ease-out 0.7s forwards;
  }

  @keyframes dotPopIn {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    70% {
      transform: scale(1.2);
    }
    100% {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes xPopIn {
    0% {
      opacity: 0;
      transform: scale(0) rotate(-45deg);
    }
    100% {
      opacity: 1;
      transform: scale(1) rotate(0deg);
    }
  }

  @media (max-width: 768px) {
    .icon-svg {
      width: 48px;
      height: 48px;
      margin: 0 auto var(--space-xs);
    }
  }

  @media (max-width: 480px) {
    .icon-svg {
      width: 36px;
      height: 36px;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .icon-svg,
    .skill:nth-child(1) .icon-svg :global(svg g path:nth-child(1)),
    .skill:nth-child(1) .icon-svg :global(svg g path:nth-child(2)),
    .skill:nth-child(2) .icon-svg :global(.content-box),
    .skill:nth-child(2) .icon-svg :global(.content-line1),
    .skill:nth-child(2) .icon-svg :global(.content-line2),
    .skill:nth-child(3) .icon-svg :global(.dot),
    .skill:nth-child(3) .icon-svg :global(.x-mark) {
      animation: none;
      opacity: 1;
      transform: none;
    }
  }
</style>
