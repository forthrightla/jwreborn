<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="noindex" />
    <title>Content Manager</title>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  </head>
  <body>
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
    <script is:inline>
      // Wait for CMS to be ready and register preview
      window.addEventListener('load', function() {
        if (window.CMS) {
          // CSS files copied to public folder for CMS preview access
          window.CMS.registerPreviewStyle('/reset.css');
          window.CMS.registerPreviewStyle('/main.css');

          // Register preview template using CMS React components
          window.CMS.registerPreviewTemplate('homepage', window.createClass({
            render: function() {
              var entry = this.props.entry;
              var data = entry.toJS().data;
              var h = window.h;
              
              var heroTitle = data.heroTitle || '';
              var methodologyTitle = (data.methodology && data.methodology.title) || 'My methodology';
              var skills = (data.methodology && data.methodology.skills) || [];
              var aboutTitle = (data.about && data.about.title) || 'Who I am';
              var aboutHeading = (data.about && data.about.heading) || '';
              var aboutBanner = (data.about && data.about.bannerImage) || '';

              return h('div', { className: 'site-content' },
                h('section', { className: 'block hero-block outer' },
                  h('div', { className: 'inner' },
                    h('div', { className: 'block-header' },
                      h('h1', { className: 'block-title' }, heroTitle)
                    )
                  )
                ),
                h('section', { className: 'portfolio-block block outer' },
                  h('div', { className: 'inner' },
                    h('div', { className: 'block-header' },
                      h('h2', { className: 'block-title line-top' }, methodologyTitle)
                    ),
                    h('div', { className: 'block-content' },
                      h('div', { className: 'expertise' },
                        skills.map(function(s) {
                          return h('div', { className: 'skill', key: s.title },
                            h('img', { className: 'icon', src: s.icon || '', alt: s.title || '' }),
                            h('h4', {}, s.title || ''),
                            h('p', {}, s.description || '')
                          );
                        })
                      )
                    )
                  )
                ),
                h('section', { className: 'about block outer' },
                  h('div', { className: 'inner' },
                    h('div', { className: 'block-inside' },
                      h('div', { className: 'block-header' },
                        h('h2', { className: 'block-title line-top' }, aboutTitle)
                      )
                    ),
                    h('div', { className: 'post-thumbnail' },
                      h('img', { src: aboutBanner, alt: 'About banner' })
                    ),
                    h('div', { className: 'post-content inner-small', style: { marginBottom: '64px', marginTop: '64px' } },
                      h('h3', {}, aboutHeading)
                    )
                  )
                )
              );
            }
          }));
        }
      });
    </script>
  </body>
</html>
