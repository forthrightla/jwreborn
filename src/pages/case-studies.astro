---
// src/pages/case-studies.astro
import Layout from "../layouts/Layout.astro";
import SimplifiedCard from "../components/SimplifiedCard.astro";
import { getCollection } from "astro:content";

// Get all case studies, sorted by featured status
const allCaseStudies = await getCollection("case-studies");
const caseStudies = allCaseStudies.sort((a, b) => {
  // Sort by featured first, then by whatever other criteria you want
  if (a.data.featured && !b.data.featured) return -1;
  if (!a.data.featured && b.data.featured) return 1;
  return 0;
});

const productDevelopmentStudies = caseStudies.filter(
  (study) =>
    study.data.tags.includes("Product Launch") ||
    study.data.tags.includes("0 -> 1 Product Strategy") ||
    study.data.tags.includes("Product Strategy"),
);

const researchStudies = caseStudies.filter(
  (study) =>
    study.data.tags.includes("Research") ||
    study.data.tags.includes("Field Research"),
);

const enterpriseStudies = caseStudies.filter(
  (study) =>
    study.data.tags.includes("Enterprise UX") ||
    study.data.tags.includes("Enterprise Software"),
);
---

<Layout
  title="Josh Wright - Case Studies | UX Design & Product Strategy"
  currentNav="case-studies"
  description="Explore case studies showcasing UX design, product strategy, and user research work across mobile apps, enterprise software, and consumer products."
>
  <main id="content" class="site-content">
    <section class="portfolio-block block outer" id="case-studies">
      <div class="inner">
        <div class="block-header">
          <h1 class="block-title line-top">Selected case studies</h1>
        </div>
        <div class="block-content">
          <p style="max-width:850px">
            Each project highlights a unique challenge and reflects my approach
            to solving it with creativity, collaboration, and impact. For
            brevity and confidentiality purposes, all case studies have been
            condensed.<br /><br />
            <strong
              >If you have any questions or would like to see more, please <a
                href="mailto:josh@joshux.com">get in touch</a
              >.</strong
            >
          </p>
        </div>

        {
          productDevelopmentStudies.length > 0 && (
            <>
              <h3>Product strategy</h3>
              <div class="block-content">
                <div class="portfolio-feed layout-tiles">
                  {productDevelopmentStudies.map((study) => (
                    <SimplifiedCard
                      href={`/work/${study.slug}`}
                      title={study.data.title}
                      img={study.data.thumbnail}
                    />
                  ))}
                </div>
              </div>
            </>
          )
        }

        {
          researchStudies.length > 0 && (
            <>
              <h3>Research studies</h3>
              <div class="block-content">
                <div class="portfolio-feed layout-tiles">
                  {researchStudies.map((study) => (
                    <SimplifiedCard
                      href={`/work/${study.slug}`}
                      title={study.data.title}
                      img={study.data.thumbnail}
                    />
                  ))}
                </div>
              </div>
            </>
          )
        }

        {
          enterpriseStudies.length > 0 && (
            <>
              <h3>Enterprise UX design</h3>
              <div class="block-content">
                <div class="portfolio-feed layout-tiles">
                  {enterpriseStudies.map((study) => (
                    <SimplifiedCard
                      href={`/work/${study.slug}`}
                      title={study.data.title}
                      img={study.data.thumbnail}
                    />
                  ))}
                </div>
              </div>
            </>
          )
        }

        <div class="block-content">
          <p style="text-align:center;">
            <a href="mailto:josh@joshux.com" class="button">Get in touch</a>
          </p>
        </div>
      </div>
    </section>
  </main>
</Layout>
